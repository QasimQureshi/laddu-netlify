<nav class="laddu-navbar overflow-x-scroll overflow-x-visible-ns flex justify-between items-center center bg-white divider-grey relative">

	<!-- Logo -->
	<a href="/" class="pl3 db mr4 h-100 w4 flex-none">
		<img src="/img/laddu.png" alt="Laddu logo" class="br0 db mb0 w-100"/>
		<!-- <img src="/img/logo.svg" alt="Kaldi logo" class="br0 db mb0 w-100"/> -->
	</a>

	<!-- Primary Nav -->
	<ul class="flex b grey-3">
		<li><a href="https://www.instagram.com/laddu.co/" class="pa3 no-underline db" target="_blank">
			<svg width="16px" height="16px">
			  <use xlink:href="#icons-instagram"></use>
			</svg>
		</a></li>
		<li><a href="https://twitter.com/laddu_co" class="pa3 no-underline db" target="_blank">
			<svg width="16px" height="16px">
			  <use xlink:href="#icons-twitter"></use>
			</svg>
		</a></li>
		<li><a href="https://www.facebook.com/Laddu-110028743668467/" class="pa3 no-underline db" target="_blank">
			<svg width="16px" height="16px">
			  <use xlink:href="#icons-facebook"></use>
			</svg>
		</a></li>
		<li><a href="/values" class="pa3 no-underline db">FAQ</a></li>
		<li><a href="#" class="sign-in pa3 no-underline db">Sign in</a></li>

		<!-- <li><a href="/values" class="pa3 no-underline db">Values</a></li> -->

		<!-- <li><a href="/post" class="pa3 no-underline db">Blog</a></li> -->

		<!-- <li><a href="/contact" class="pa3 no-underline db">Contact</a></li> -->
	</ul>
</nav>

{{ partial "register_signin" }}

<script type="text/javascript">
	var baseURL = ((window.location.href.indexOf('lvh.me') !== -1 || window.location.href.indexOf('localhost') !== -1) ? 'http://lvh.me:3001' : 'api.laddu.co');

	document.addEventListener('DOMContentLoaded', (event) => {

		if( window.location.hash === "#signout"){
			localStorage.removeItem('sessionId');
		}

		// If the user previously signed in, we show an authenticated state in the nav
		let user = JSON.parse(localStorage.getItem('sessionId'));

		if( !!user ){

			// authenticate session with the backend, and get unread message count
			var request = new XMLHttpRequest();

            request.open('POST', `${baseURL}/unread`, true);
            request.setRequestHeader('Content-Type', 'application/json; charset=UTF-8');

            request.onload = function(data) {
                
	            if (this.status === 200) {

	                // checking email validity
	                let response = JSON.parse(this.response).response;
	                debugger;

	            } else {
	                // We reached our target server, but it returned an error
	                console.log('Error fetching unreads')

	            }
	        };

	        request.onerror = function(errObj) {
	          // There was a connection error of some sort
	          debugger;
	        };
	        // debugger;
	        // request.send( JSON.stringify( {session: user.session}) );
	        // request.send( `authenticity_token=${encodeURIComponent(user.session)}` );


		}
	})
</script>